#ifndef __IMGTOOLS_H__  // __IMGTOOLS_H__
#define __IMGTOOLS_H__

#include "types.h"

#define BCSPLMAT {{{{64,-80,-80,100,32,16,-40,-20,32,-40,16,-20,16,8,8,4},\
                    {-192,192,240,-240,-64,-40,80,50,-96,96,-48,48,-32,-20,-16,-10},\
                    {144,-144,-180,180,40,32,-50,-40,72,-72,36,-36,20,16,10,8},\
                    {-32,32,40,-40,-8,-8,10,10,-16,16,-8,8,-4,-4,-2,-2},\
                    {-192,240,192,-240,-96,-48,96,48,-64,80,-40,50,-32,-16,-20,-10},\
                    {576,-576,-576,576,192,120,-192,-120,192,-192,120,-120,64,40,40,25},\
                    {-432,432,432,-432,-120,-96,120,96,-144,144,-90,90,-40,-32,-25,-20},\
                    {96,-96,-96,96,24,24,-24,-24,32,-32,20,-20,8,8,5,5},\
                    {144,-180,-144,180,72,36,-72,-36,40,-50,32,-40,20,10,16,8},\
                    {-432,432,432,-432,-144,-90,144,90,-120,120,-96,96,-40,-25,-32,-20},\
                    {324,-324,-324,324,90,72,-90,-72,90,-90,72,-72,25,20,20,16},\
                    {-72,72,72,-72,-18,-18,18,18,-20,20,-16,16,-5,-5,-4,-4},\
                    {-32,40,32,-40,-16,-8,16,8,-8,10,-8,10,-4,-2,-4,-2},\
                    {96,-96,-96,96,32,20,-32,-20,24,-24,24,-24,8,5,8,5},\
                    {-72,72,72,-72,-20,-16,20,16,-18,18,-18,18,-5,-4,-5,-4},\
                    {16,-16,-16,16,4,4,-4,-4,4,-4,4,-4,1,1,1,1}},\
                   {{-16,0,20,0,0,0,0,0,-8,0,-4,0,0,0,0,0},\
                    {0,0,0,0,-8,0,10,0,0,0,0,0,-4,0,-2,0},\
                    {48,-48,-60,60,16,8,-20,-10,24,-24,12,-12,8,4,4,2},\
                    {-32,32,40,-40,-8,-8,10,10,-16,16,-8,8,-4,-4,-2,-2},\
                    {48,0,-48,0,0,0,0,0,16,0,10,0,0,0,0,0},\
                    {0,0,0,0,24,0,-24,0,0,0,0,0,8,0,5,0},\
                    {-144,144,144,-144,-48,-24,48,24,-48,48,-30,30,-16,-8,-10,-5},\
                    {96,-96,-96,96,24,24,-24,-24,32,-32,20,-20,8,8,5,5},\
                    {-36,0,36,0,0,0,0,0,-10,0,-8,0,0,0,0,0},\
                    {0,0,0,0,-18,0,18,0,0,0,0,0,-5,0,-4,0},\
                    {108,-108,-108,108,36,18,-36,-18,30,-30,24,-24,10,5,8,4},\
                    {-72,72,72,-72,-18,-18,18,18,-20,20,-16,16,-5,-5,-4,-4},\
                    {8,0,-8,0,0,0,0,0,2,0,2,0,0,0,0,0},\
                    {0,0,0,0,4,0,-4,0,0,0,0,0,1,0,1,0},\
                    {-24,24,24,-24,-8,-4,8,4,-6,6,-6,6,-2,-1,-2,-1},\
                    {16,-16,-16,16,4,4,-4,-4,4,-4,4,-4,1,1,1,1}},\
                   {{0,-16,0,20,0,0,0,0,0,-8,0,-4,0,0,0,0},\
                    {0,0,0,0,0,-8,0,10,0,0,0,0,0,-4,0,-2},\
                    {-48,48,60,-60,-8,-16,10,20,-24,24,-12,12,-4,-8,-2,-4},\
                    {-32,32,40,-40,-8,-8,10,10,-16,16,-8,8,-4,-4,-2,-2},\
                    {0,48,0,-48,0,0,0,0,0,16,0,10,0,0,0,0},\
                    {0,0,0,0,0,24,0,-24,0,0,0,0,0,8,0,5},\
                    {144,-144,-144,144,24,48,-24,-48,48,-48,30,-30,8,16,5,10},\
                    {96,-96,-96,96,24,24,-24,-24,32,-32,20,-20,8,8,5,5},\
                    {0,-36,0,36,0,0,0,0,0,-10,0,-8,0,0,0,0},\
                    {0,0,0,0,0,-18,0,18,0,0,0,0,0,-5,0,-4},\
                    {-108,108,108,-108,-18,-36,18,36,-30,30,-24,24,-5,-10,-4,-8},\
                    {-72,72,72,-72,-18,-18,18,18,-20,20,-16,16,-5,-5,-4,-4},\
                    {0,8,0,-8,0,0,0,0,0,2,0,2,0,0,0,0},\
                    {0,0,0,0,0,4,0,-4,0,0,0,0,0,1,0,1},\
                    {24,-24,-24,24,4,8,-4,-8,6,-6,6,-6,1,2,1,2},\
                    {16,-16,-16,16,4,4,-4,-4,4,-4,4,-4,1,1,1,1}}},\
                  {{{-16,20,0,0,-8,-4,0,0,0,0,0,0,0,0,0,0},\
                    {48,-48,0,0,16,10,0,0,0,0,0,0,0,0,0,0},\
                    {-36,36,0,0,-10,-8,0,0,0,0,0,0,0,0,0,0},\
                    {8,-8,0,0,2,2,0,0,0,0,0,0,0,0,0,0},\
                    {0,0,0,0,0,0,0,0,-8,10,0,0,-4,-2,0,0},\
                    {0,0,0,0,0,0,0,0,24,-24,0,0,8,5,0,0},\
                    {0,0,0,0,0,0,0,0,-18,18,0,0,-5,-4,0,0},\
                    {0,0,0,0,0,0,0,0,4,-4,0,0,1,1,0,0},\
                    {48,-60,-48,60,24,12,-24,-12,16,-20,8,-10,8,4,4,2},\
                    {-144,144,144,-144,-48,-30,48,30,-48,48,-24,24,-16,-10,-8,-5},\
                    {108,-108,-108,108,30,24,-30,-24,36,-36,18,-18,10,8,5,4},\
                    {-24,24,24,-24,-6,-6,6,6,-8,8,-4,4,-2,-2,-1,-1},\
                    {-32,40,32,-40,-16,-8,16,8,-8,10,-8,10,-4,-2,-4,-2},\
                    {96,-96,-96,96,32,20,-32,-20,24,-24,24,-24,8,5,8,5},\
                    {-72,72,72,-72,-20,-16,20,16,-18,18,-18,18,-5,-4,-5,-4},\
                    {16,-16,-16,16,4,4,-4,-4,4,-4,4,-4,1,1,1,1}},\
                   {{4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},\
                    {0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0},\
                    {-12,12,0,0,-4,-2,0,0,0,0,0,0,0,0,0,0},\
                    {8,-8,0,0,2,2,0,0,0,0,0,0,0,0,0,0},\
                    {0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0},\
                    {0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0},\
                    {0,0,0,0,0,0,0,0,-6,6,0,0,-2,-1,0,0},\
                    {0,0,0,0,0,0,0,0,4,-4,0,0,1,1,0,0},\
                    {-12,0,12,0,0,0,0,0,-4,0,-2,0,0,0,0,0},\
                    {0,0,0,0,-6,0,6,0,0,0,0,0,-2,0,-1,0},\
                    {36,-36,-36,36,12,6,-12,-6,12,-12,6,-6,4,2,2,1},\
                    {-24,24,24,-24,-6,-6,6,6,-8,8,-4,4,-2,-2,-1,-1},\
                    {8,0,-8,0,0,0,0,0,2,0,2,0,0,0,0,0},\
                    {0,0,0,0,4,0,-4,0,0,0,0,0,1,0,1,0},\
                    {-24,24,24,-24,-8,-4,8,4,-6,6,-6,6,-2,-1,-2,-1},\
                    {16,-16,-16,16,4,4,-4,-4,4,-4,4,-4,1,1,1,1}},\
                   {{0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0},\
                    {0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0},\
                    {12,-12,0,0,2,4,0,0,0,0,0,0,0,0,0,0},\
                    {8,-8,0,0,2,2,0,0,0,0,0,0,0,0,0,0},\
                    {0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0},\
                    {0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0},\
                    {0,0,0,0,0,0,0,0,6,-6,0,0,1,2,0,0},\
                    {0,0,0,0,0,0,0,0,4,-4,0,0,1,1,0,0},\
                    {0,-12,0,12,0,0,0,0,0,-4,0,-2,0,0,0,0},\
                    {0,0,0,0,0,-6,0,6,0,0,0,0,0,-2,0,-1},\
                    {-36,36,36,-36,-6,-12,6,12,-12,12,-6,6,-2,-4,-1,-2},\
                    {-24,24,24,-24,-6,-6,6,6,-8,8,-4,4,-2,-2,-1,-1},\
                    {0,8,0,-8,0,0,0,0,0,2,0,2,0,0,0,0},\
                    {0,0,0,0,0,4,0,-4,0,0,0,0,0,1,0,1},\
                    {24,-24,-24,24,4,8,-4,-8,6,-6,6,-6,1,2,1,2},\
                    {16,-16,-16,16,4,4,-4,-4,4,-4,4,-4,1,1,1,1}}},\
                  {{{0,0,-16,20,0,0,-8,-4,0,0,0,0,0,0,0,0},\
                    {0,0,48,-48,0,0,16,10,0,0,0,0,0,0,0,0},\
                    {0,0,-36,36,0,0,-10,-8,0,0,0,0,0,0,0,0},\
                    {0,0,8,-8,0,0,2,2,0,0,0,0,0,0,0,0},\
                    {0,0,0,0,0,0,0,0,0,0,-8,10,0,0,-4,-2},\
                    {0,0,0,0,0,0,0,0,0,0,24,-24,0,0,8,5},\
                    {0,0,0,0,0,0,0,0,0,0,-18,18,0,0,-5,-4},\
                    {0,0,0,0,0,0,0,0,0,0,4,-4,0,0,1,1},\
                    {-48,60,48,-60,-24,-12,24,12,-8,10,-16,20,-4,-2,-8,-4},\
                    {144,-144,-144,144,48,30,-48,-30,24,-24,48,-48,8,5,16,10},\
                    {-108,108,108,-108,-30,-24,30,24,-18,18,-36,36,-5,-4,-10,-8},\
                    {24,-24,-24,24,6,6,-6,-6,4,-4,8,-8,1,1,2,2},\
                    {-32,40,32,-40,-16,-8,16,8,-8,10,-8,10,-4,-2,-4,-2},\
                    {96,-96,-96,96,32,20,-32,-20,24,-24,24,-24,8,5,8,5},\
                    {-72,72,72,-72,-20,-16,20,16,-18,18,-18,18,-5,-4,-5,-4},\
                    {16,-16,-16,16,4,4,-4,-4,4,-4,4,-4,1,1,1,1}},\
                   {{0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0},\
                    {0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0},\
                    {0,0,-12,12,0,0,-4,-2,0,0,0,0,0,0,0,0},\
                    {0,0,8,-8,0,0,2,2,0,0,0,0,0,0,0,0},\
                    {0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0},\
                    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0},\
                    {0,0,0,0,0,0,0,0,0,0,-6,6,0,0,-2,-1},\
                    {0,0,0,0,0,0,0,0,0,0,4,-4,0,0,1,1},\
                    {12,0,-12,0,0,0,0,0,2,0,4,0,0,0,0,0},\
                    {0,0,0,0,6,0,-6,0,0,0,0,0,1,0,2,0},\
                    {-36,36,36,-36,-12,-6,12,6,-6,6,-12,12,-2,-1,-4,-2},\
                    {24,-24,-24,24,6,6,-6,-6,4,-4,8,-8,1,1,2,2},\
                    {8,0,-8,0,0,0,0,0,2,0,2,0,0,0,0,0},\
                    {0,0,0,0,4,0,-4,0,0,0,0,0,1,0,1,0},\
                    {-24,24,24,-24,-8,-4,8,4,-6,6,-6,6,-2,-1,-2,-1},\
                    {16,-16,-16,16,4,4,-4,-4,4,-4,4,-4,1,1,1,1}},\
                   {{0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0},\
                    {0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0},\
                    {0,0,12,-12,0,0,2,4,0,0,0,0,0,0,0,0},\
                    {0,0,8,-8,0,0,2,2,0,0,0,0,0,0,0,0},\
                    {0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0},\
                    {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},\
                    {0,0,0,0,0,0,0,0,0,0,6,-6,0,0,1,2},\
                    {0,0,0,0,0,0,0,0,0,0,4,-4,0,0,1,1},\
                    {0,12,0,-12,0,0,0,0,0,2,0,4,0,0,0,0},\
                    {0,0,0,0,0,6,0,-6,0,0,0,0,0,1,0,2},\
                    {36,-36,-36,36,6,12,-6,-12,6,-6,12,-12,1,2,2,4},\
                    {24,-24,-24,24,6,6,-6,-6,4,-4,8,-8,1,1,2,2},\
                    {0,8,0,-8,0,0,0,0,0,2,0,2,0,0,0,0},\
                    {0,0,0,0,0,4,0,-4,0,0,0,0,0,1,0,1},\
                    {24,-24,-24,24,4,8,-4,-8,6,-6,6,-6,1,2,1,2},\
                    {16,-16,-16,16,4,4,-4,-4,4,-4,4,-4,1,1,1,1}}}}

fp_t **rotate(fp_t **sub_img,int xl,int xh,int yl,int yh,fp_t angle);
fp_t **resample(fp_t **img,int xli,int xhi,int yli,int yhi,fp_t range,int xlo,int xho,int ylo,int yho);
fp_t **rebin(fp_t **img,int xli,int xhi,int yli,int yhi,fp_t range,int xlo,int xho,int ylo,int yho);
fp_t **make_window(int nx,int ny,int sm);

#endif                // __IMGTOOLS_H__
